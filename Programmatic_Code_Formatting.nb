(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9692,        180]
NotebookOptionsPosition[      9448,        167]
NotebookOutlinePosition[      9793,        182]
CellTagsIndexPosition[      9750,        179]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", "=", "0"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
    "\"\<-E^(-I y) Function[x, cc[x]] + Function[x, b[x]] Function[x, r[x]] + \
E^(I n y) (-(Function[x, a[x]]^2 - Function[x, a[x]] Function[x, r[x]] + (1 + \
I) (1 + (1 + I) n) Function[x, r[x]]^2) Function[{x, n}, 0] + n (1 + n) \
Function[x, r[x]]^2 Function[{x, n}, ff[x, n]]) - Function[x, 0] (Function[x, \
a[x]] + I Function[x, r[x]]) (1 + E^(I n y) ((1 - I) Function[{x, n}, 0] + n \
Function[{x, n}, ff[x, n]]))\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<E^(\>\"", "~~", 
         RowBox[{"Shortest", "[", "arg__", "]"}], "~~", "\"\<)\>\""}], 
        "\[RuleDelayed]", 
        RowBox[{"\"\<Exp[\>\"", "~~", "arg", "~~", "\"\<]\>\""}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<(\>\"", "\[RuleDelayed]", 
        RowBox[{"\"\<(\\n\>\"", "<>", 
         RowBox[{"StringJoin", "@@", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"\"\< \>\"", ",", 
            RowBox[{"++", "n"}]}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<)\>\"", "\[RuleDelayed]", 
        RowBox[{"\"\<\\n\>\"", "<>", 
         RowBox[{"StringJoin", "@@", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"\"\< \>\"", ",", 
            RowBox[{"--", "n"}]}], "]"}]}], "<>", "\"\<)\>\""}]}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FixedPoint", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<(\\n\>\"", "~~", 
         RowBox[{"(", 
          RowBox[{"x", ":", 
           RowBox[{"\"\< \>\"", ".."}]}], ")"}], "~~", 
         RowBox[{"Shortest", "[", "quant__", "]"}], "~~", "\"\<\\n\>\"", "~~", 
         RowBox[{"(", 
          RowBox[{"y", ":", 
           RowBox[{"\"\< \>\"", "..."}]}], ")"}], "~~", "\"\<)\>\""}], "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", 
           RowBox[{"ToString", "@", 
            RowBox[{"Shortest", "[", "quant", "]"}]}], "]"}], "\[LessEqual]", 
          "39"}], "&&", 
         RowBox[{
          RowBox[{"StringLength", "[", "y", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"StringLength", "[", "x", "]"}], "-", "1"}]}]}]}], ":>", 
       RowBox[{"\"\<(\>\"", "~~", "quant", "~~", "\"\<)\>\""}]}]}], "]"}], 
    "&"}], ",", "\[IndentingNewLine]", "%"}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.782336511967063*^9, 3.7823365722718105`*^9}, {
   3.782336633904009*^9, 3.7823367310836997`*^9}, {3.7823368255122013`*^9, 
   3.782336851790934*^9}, {3.7823369018440933`*^9, 3.7823369019039335`*^9}, {
   3.7823369638812094`*^9, 3.782337037200158*^9}, {3.782337090487768*^9, 
   3.7823371573260984`*^9}, {3.7823372106844206`*^9, 3.782337244950794*^9}, {
   3.7823372924807005`*^9, 3.78233729260437*^9}, {3.782337345850991*^9, 
   3.7823373491212463`*^9}, {3.782337419846131*^9, 3.78233752559237*^9}, {
   3.7823375809792676`*^9, 3.7823376312049665`*^9}, {3.7823382452001*^9, 
   3.782338348572254*^9}, {3.7823384034269176`*^9, 3.7823384746694126`*^9}, {
   3.7823390970257874`*^9, 3.7823391395905867`*^9}, {3.7823391793683095`*^9, 
   3.7823392034946384`*^9}, {3.782339286672402*^9, 3.782339294838739*^9}, {
   3.782339348493024*^9, 3.7823393559945827`*^9}, {3.782339571766323*^9, 
   3.7823396603437643`*^9}, 3.7823396957740545`*^9, {3.782339989307249*^9, 
   3.782339999824289*^9}, {3.782340047452078*^9, 3.782340058346121*^9}, {
   3.782340109924655*^9, 3.7823401727768517`*^9}, {3.782340205492197*^9, 
   3.782340242558485*^9}, {3.7823404497337675`*^9, 3.782340468189026*^9}, 
   3.7823405006271577`*^9, 3.7823405447553015`*^9, {3.7823406620921264`*^9, 
   3.782340675233527*^9}, {3.7823433662198277`*^9, 3.782343518906207*^9}, 
   3.782343552766636*^9, {3.7823436689821568`*^9, 3.7823437247717333`*^9}, {
   3.7823437639445295`*^9, 3.782343775528209*^9}, {3.7823438654131107`*^9, 
   3.7823439015350924`*^9}, {3.7823439391655307`*^9, 
   3.7823439709205093`*^9}, {3.782344078179662*^9, 3.7823440792827253`*^9}, {
   3.782344200321924*^9, 3.7823442158496513`*^9}, {3.7823442674244275`*^9, 
   3.7823444628218546`*^9}, {3.7823445066462526`*^9, 3.782344533558717*^9}, {
   3.7823445965407276`*^9, 3.782344657504633*^9}, {3.7823447001187167`*^9, 
   3.7823447414692497`*^9}, {3.7823448408492155`*^9, 
   3.7823448649252014`*^9}, {3.7823449695527983`*^9, 
   3.7823449723727245`*^9}, {3.7823450792663994`*^9, 
   3.7823452672483273`*^9}, {3.7823453441459475`*^9, 
   3.7823453442741113`*^9}, {3.782345391896433*^9, 3.78234544666979*^9}, {
   3.78234549785464*^9, 3.782345497999253*^9}, {3.7823455688692536`*^9, 
   3.782345683628479*^9}, {3.782345736121002*^9, 3.7823457437452135`*^9}, {
   3.78234577673501*^9, 3.7823457966500173`*^9}, {3.7823458593562217`*^9, 
   3.7823458825664897`*^9}, {3.7823459409272594`*^9, 
   3.7823459526834955`*^9}, {3.782346032352079*^9, 3.7823460483385067`*^9}, {
   3.7823461592180567`*^9, 3.7823461627616425`*^9}, {3.7823462886398783`*^9, 
   3.782346345798852*^9}, {3.7823464097646403`*^9, 3.782346423517547*^9}, {
   3.7823464819715977`*^9, 3.782346538025053*^9}, 3.782346694669915*^9, {
   3.7823467508914447`*^9, 3.7823467753140135`*^9}, {3.782346806657134*^9, 
   3.782346879179743*^9}, {3.782346918732577*^9, 3.7823469251285477`*^9}, 
   3.782346968733594*^9, {3.782347203642808*^9, 3.7823472093431373`*^9}, {
   3.7823474645644393`*^9, 3.7823474946214657`*^9}, 3.782347531648554*^9, {
   3.782347568551403*^9, 3.7823477065045056`*^9}, {3.7823477914367237`*^9, 
   3.7823478263957415`*^9}, {3.782347871161648*^9, 3.782347897639737*^9}, {
   3.7823480141699486`*^9, 3.7823480719737363`*^9}, {3.7823481235351458`*^9, 
   3.7823481958597355`*^9}, 3.7823482590940013`*^9, {3.782348299963255*^9, 
   3.7823483829998913`*^9}, {3.7823484161467404`*^9, 3.782348416346712*^9}, {
   3.7823485142943125`*^9, 3.7823485145027685`*^9}, {3.7823485463445644`*^9, 
   3.7823485884111686`*^9}, {3.7823487276961284`*^9, 3.782348729236024*^9}, {
   3.782348760126896*^9, 3.782348760267028*^9}, {3.782349437637265*^9, 
   3.7823494377250304`*^9}, 3.782350205251177*^9, {3.7823503158974066`*^9, 
   3.7823503226125364`*^9}, {3.78235035667542*^9, 3.7823503598070984`*^9}, {
   3.7823504032460775`*^9, 3.782350403284974*^9}, {3.782350485789113*^9, 
   3.782350628095665*^9}, {3.782350677265357*^9, 3.782350683496305*^9}, {
   3.7823509034547033`*^9, 3.7823510841942234`*^9}, {3.7823513458755007`*^9, 
   3.782351697420066*^9}, {3.782351735233469*^9, 3.7823517788071685`*^9}, {
   3.782351975266737*^9, 3.7823520267633104`*^9}, {3.7823520674266124`*^9, 
   3.782352075139614*^9}, {3.782352168772727*^9, 3.7823521839708767`*^9}, {
   3.782352226668784*^9, 3.7823522364991064`*^9}, 3.782352272508854*^9, {
   3.7823523441333675`*^9, 3.782352347158353*^9}, {3.782352425922329*^9, 
   3.7823524549281826`*^9}, {3.7823525446814485`*^9, 3.7823526445638523`*^9}, 
   3.7823531401071887`*^9, {3.782353267560162*^9, 3.782353268265277*^9}, {
   3.7823533969221716`*^9, 3.7823533970458403`*^9}, {3.7823534619247236`*^9, 
   3.782353472634224*^9}, {3.7823535449006014`*^9, 3.7823535891504383`*^9}, {
   3.782354319325798*^9, 3.782354319573642*^9}, {3.782354350014617*^9, 
   3.7823544176248183`*^9}, {3.7823545186675835`*^9, 3.782354578054141*^9}, {
   3.782354619077504*^9, 3.7823546676782336`*^9}, {3.78235470802396*^9, 
   3.782354708439848*^9}, {3.7823549893397064`*^9, 3.782354989374613*^9}, {
   3.7823580374841104`*^9, 3.7823580392907963`*^9}, {3.7823580705781527`*^9, 
   3.782358096467184*^9}, {3.78235813627078*^9, 3.782358136419173*^9}, {
   3.78235822747122*^9, 3.7823582808528433`*^9}, {3.782358362916177*^9, 
   3.782358367219616*^9}, {3.7823583974951243`*^9, 3.782358424709673*^9}, {
   3.782358472937467*^9, 3.7823585575850706`*^9}, {3.7823586455046587`*^9, 
   3.782358668566944*^9}, {3.7823587406124105`*^9, 3.782358758375165*^9}, {
   3.7823588444133997`*^9, 3.782358851722437*^9}, {3.7823589606947365`*^9, 
   3.7823589640258656`*^9}, 3.7823590672140384`*^9, {3.7823594072108064`*^9, 
   3.7823594406773443`*^9}, {3.782359472744584*^9, 3.782359537779224*^9}, {
   3.7823598376240234`*^9, 3.782359847939577*^9}, {3.782359899629099*^9, 
   3.7823599037206926`*^9}, {3.782359973502079*^9, 3.7823599735858555`*^9}, {
   3.782360004160593*^9, 3.782360004288252*^9}, {3.782360241604615*^9, 
   3.782360250636097*^9}, {3.7823605102981005`*^9, 3.782360519901044*^9}, 
   3.7823606899292917`*^9, {3.7823607353235064`*^9, 3.782360744651718*^9}, 
   3.7823610860783587`*^9, {3.78236114574581*^9, 3.782361147721527*^9}}]
},
WindowSize->{1920, 1007},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 8886, 145, 332, "Input"]
}
]
*)

(* End of internal cache information *)
